
<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog - Ortensia Group</title>
    <meta name="description" content="Consigli e guide per il giardinaggio professionale. Scopri tutti i segreti per mantenere il tuo giardino perfetto con gli esperti di Ortensia Group.">
    <meta name="keywords" content="blog giardinaggio, consigli giardino, potatura, irrigazione, cura piante, Milano">
    
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-green: #2C5F2D;
            --secondary-green: #4A7C59;
            --accent-gold: #D4AF37;
            --light-green: #E8F5E8;
            --dark-text: #1A3A1B;
            --white: #FFFFFF;
            --light-gray: #F8F9FA;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: var(--dark-text);
            background-color: var(--light-gray);
        }

        .gradient-bg {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--secondary-green) 100%);
        }

        .blog-card {
            background: var(--white);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .blog-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
            border-color: var(--accent-gold);
        }

        .blog-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .blog-card:hover .blog-image {
            transform: scale(1.05);
        }

        .category-badge {
            background: var(--light-green);
            color: var(--primary-green);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-gold), #E6C547);
            color: var(--dark-text);
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(212, 175, 55, 0.3);
            display: inline-flex;
            align-items: center;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
            color: var(--dark-text);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-green);
            border: 2px solid var(--primary-green);
            padding: 0.8rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .btn-outline:hover {
            background: var(--primary-green);
            color: var(--white);
            transform: translateY(-2px);
        }

        .navbar {
            background: var(--white);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .navbar-brand {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-green);
            text-decoration: none;
            display: flex;
            align-items: center;
        }

        .navbar-brand img {
            height: 40px;
            width: auto;
        }

        .navbar-nav {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .navbar-nav a {
            color: var(--dark-text);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .navbar-nav a:hover {
            color: var(--primary-green);
        }

        .filter-btn {
            background: var(--white);
            border: 2px solid var(--primary-green);
            color: var(--primary-green);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: var(--primary-green);
            color: var(--white);
        }

        .pagination-btn {
            background: var(--white);
            border: 2px solid var(--primary-green);
            color: var(--primary-green);
            padding: 0.5rem 1rem;
            border-radius: 10px;
            font-weight: 500;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .pagination-btn:hover,
        .pagination-btn.active {
            background: var(--primary-green);
            color: var(--white);
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 4rem 0;
        }

        .spinner {
            border: 4px solid var(--light-green);
            border-left-color: var(--primary-green);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hero-section {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--secondary-green) 100%);
            color: var(--white);
            padding: 4rem 0;
            text-align: center;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 1rem;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .footer {
            background: var(--primary-green);
            color: var(--white);
            padding: 3rem 0;
            margin-top: 4rem;
        }

        .footer-section h3 {
            color: var(--accent-gold);
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .footer-section a {
            color: var(--white);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-section a:hover {
            color: var(--accent-gold);
        }

        @media (max-width: 768px) {
            .hero-title {
                font-size: 2rem;
            }
            
            .navbar-nav {
                display: none;
            }
            
            .hero-section {
                padding: 2rem 0;
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="index.html" class="navbar-brand">
                <img src="/ortensia-logo.png">
            </a>
            <div class="navbar-nav">
                <a href="index.html">Home</a>
                <a href="blog.html">Blog</a>
                <a href="lavori.html">I Nostri Lavori</a>
                <a href="index.html#contatti">Contatti</a>
            </div>
            <div class="md:hidden">
                <i class="fas fa-bars text-2xl text-primary-green cursor-pointer"></i>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="container mx-auto px-4">
            <h1 class="hero-title">Blog Ortensia Group</h1>
            <p class="hero-subtitle">
                Consigli, guide e segreti per mantenere il tuo giardino perfetto in ogni stagione
            </p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Filters -->
        <div class="mb-8">
            <h2 class="text-2xl font-bold mb-4 text-center">Esplora i Nostri Articoli</h2>
            <div class="flex flex-wrap justify-center gap-4" id="category-filters">
                <button class="filter-btn active" data-category="">Tutti</button>
                <!-- Categories will be loaded dynamically -->
            </div>
        </div>

        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <span class="ml-4 text-lg">Caricamento articoli...</span>
        </div>

        <!-- Articles Grid -->
        <div id="articles-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-8" style="display: none;">
            <!-- Articles will be loaded dynamically -->
        </div>

        <!-- No Articles Message -->
        <div id="no-articles" class="text-center py-8" style="display: none;">
            <i class="fas fa-newspaper text-6xl text-gray-400 mb-4"></i>
            <h3 class="text-2xl font-bold mb-2">Nessun articolo trovato</h3>
            <p class="text-gray-600">Non ci sono articoli per la categoria selezionata.</p>
        </div>

        <!-- Pagination -->
        <div id="pagination" class="flex justify-center items-center gap-4 mt-8" style="display: none;">
            <button id="prev-btn" class="pagination-btn" onclick="changePage(-1)">
                <i class="fas fa-chevron-left mr-2"></i>Precedente
            </button>
            <span id="page-info" class="text-lg font-semibold"></span>
            <button id="next-btn" class="pagination-btn" onclick="changePage(1)">
                Successivo<i class="fas fa-chevron-right ml-2"></i>
            </button>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-4 gap-8">
                <div class="footer-section">
                    <h3 class="text-xl font-bold mb-4">
                        <i class="fas fa-leaf mr-2"></i>Ortensia Group
                    </h3>
                    <p class="text-white mb-4">
                        Da oltre 25 anni trasformiamo i sogni in realtà, creando spazi verdi unici e sostenibili.
                    </p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-2xl hover:text-accent-gold transition-colors">
                            <i class="fab fa-facebook"></i>
                        </a>
                        <a href="#" class="text-2xl hover:text-accent-gold transition-colors">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="text-2xl hover:text-accent-gold transition-colors">
                            <i class="fab fa-linkedin"></i>
                        </a>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h3>Servizi</h3>
                    <ul class="space-y-2">
                        <li><a href="#servizi">Progettazione Giardini</a></li>
                        <li><a href="#servizi">Impianti Irrigazione</a></li>
                        <li><a href="#servizi">Potatura</a></li>
                        <li><a href="#servizi">Disboscamento</a></li>
                        <li><a href="#servizi">Sanificazione</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Azienda</h3>
                    <ul class="space-y-2">
                        <li><a href="index.html#chi-siamo">Chi Siamo</a></li>
                        <li><a href="lavori.html">I Nostri Lavori</a></li>
                        <li><a href="blog.html">Blog</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                        <li><a href="cookie.html">Cookie Policy</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Contatti</h3>
                    <div class="space-y-2">
                        <p><i class="fas fa-phone mr-2"></i>02 43416807</p>
                        <p><i class="fas fa-mobile-alt mr-2"></i>347 6764038</p>
                        <p><i class="fas fa-envelope mr-2"></i><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="dcb5b2bab39cb3aea8b9b2afb5bdbbaeb3a9acf2b2b9a8">[email&#160;protected]</a></p>
                        <p><i class="fas fa-map-marker-alt mr-2"></i>Via Fanfulla da Lodi 5, 20090 Trezzano sul Naviglio (MI)</p>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-secondary-green mt-8 pt-8 text-center">
                <p>&copy; 2024 Ortensia Group. Tutti i diritti riservati.</p>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/config.js"></script>
    <script src="js/scripts.js"></script>

    <script>
        // Global variables
        let currentPage = 1;
        let articlesPerPage = 6;
        let totalPages = 1;
        let currentCategory = '';
        let allCategories = [];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initializePage();
        });

        async function initializePage() {
            console.log('🚀 Initializing blog page...');
            
            // Wait for API to be ready
            await waitForAPI();
            
            // Load categories
            await loadCategories();
            
            // Load articles
            await loadArticles();
            
            console.log('✅ Blog page initialized');
        }

        function waitForAPI() {
            return new Promise((resolve) => {
                const checkAPI = () => {
                    if (window.OrtensiaAPI && window.OrtensiaAPI.loadBlogPosts) {
                        resolve();
                    } else {
                        setTimeout(checkAPI, 100);
                    }
                };
                checkAPI();
            });
        }

        async function loadCategories() {
            try {
                const categories = await window.OrtensiaAPI.loadCategories('blog');
                allCategories = categories;
                
                const filtersContainer = document.getElementById('category-filters');
                const existingAll = filtersContainer.querySelector('[data-category=""]');
                
                // Add category filters
                categories.forEach(category => {
                    const button = document.createElement('button');
                    button.className = 'filter-btn';
                    button.setAttribute('data-category', category.id);
                    button.textContent = category.name;
                    button.onclick = () => filterByCategory(category.id);
                    filtersContainer.appendChild(button);
                });
                
                console.log('✅ Categories loaded:', categories.length);
            } catch (error) {
                console.error('❌ Error loading categories:', error);
            }
        }

        async function loadArticles() {
            try {
                showLoading(true);
                
                const offset = (currentPage - 1) * articlesPerPage;
                const { data: articles, count } = await window.OrtensiaAPI.loadBlogPosts(
                    articlesPerPage, 
                    offset, 
                    currentCategory || null
                );
                
                totalPages = Math.ceil(count / articlesPerPage);
                
                displayArticles(articles);
                updatePagination();
                
                console.log(`✅ Loaded ${articles.length} articles (page ${currentPage})`);
                
            } catch (error) {
                console.error('❌ Error loading articles:', error);
                showNoArticles();
            } finally {
                showLoading(false);
            }
        }

        function displayArticles(articles) {
            const grid = document.getElementById('articles-grid');
            const noArticles = document.getElementById('no-articles');
            
            if (articles.length === 0) {
                showNoArticles();
                return;
            }
            
            // Show grid, hide no articles message
            grid.style.display = 'grid';
            noArticles.style.display = 'none';
            
            // Clear existing articles
            grid.innerHTML = '';
            
            // Add articles
            articles.forEach(article => {
                const articleCard = createArticleCard(article);
                grid.appendChild(articleCard);
            });
        }

        function createArticleCard(article) {
            const card = document.createElement('div');
            card.className = 'blog-card animate-fade-in';
            
            const categoryName = article.categories ? article.categories.name : 'Senza categoria';
            const excerpt = article.excerpt || article.content.substring(0, 150) + '...';
            const featuredImage = article.featured_image || 'https://via.placeholder.com/400x200/2C5F2D/FFFFFF?text=Ortensia+Group';
            
            card.innerHTML = `
                <div class="overflow-hidden">
                    <img src="${featuredImage}" alt="${article.title}" class="blog-image">
                </div>
                <div class="p-6">
                    <div class="flex items-center justify-between mb-3">
                        <span class="category-badge">${categoryName}</span>
                        <span class="text-sm text-gray-500">${formatDate(article.published_at)}</span>
                    </div>
                    <h3 class="text-xl font-bold mb-3 text-primary-green">${article.title}</h3>
                    <p class="text-gray-600 mb-4">${excerpt}</p>
                    <div class="flex justify-between items-center">
                        <a href="articolo.html?slug=${article.slug}" class="btn-primary">
                            <i class="fas fa-book-open mr-2"></i>
                            Leggi di più
                        </a>
                        <div class="flex items-center text-sm text-gray-500">
                            <i class="fas fa-clock mr-1"></i>
                            ${estimateReadingTime(article.content)} min
                        </div>
                    </div>
                </div>
            `;
            
            return card;
        }

        function showLoading(show) {
            const loading = document.getElementById('loading');
            const grid = document.getElementById('articles-grid');
            const noArticles = document.getElementById('no-articles');
            
            if (show) {
                loading.style.display = 'flex';
                grid.style.display = 'none';
                noArticles.style.display = 'none';
            } else {
                loading.style.display = 'none';
            }
        }

        function showNoArticles() {
            const loading = document.getElementById('loading');
            const grid = document.getElementById('articles-grid');
            const noArticles = document.getElementById('no-articles');
            
            loading.style.display = 'none';
            grid.style.display = 'none';
            noArticles.style.display = 'block';
        }

        function updatePagination() {
            const pagination = document.getElementById('pagination');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const pageInfo = document.getElementById('page-info');
            
            if (totalPages <= 1) {
                pagination.style.display = 'none';
                return;
            }
            
            pagination.style.display = 'flex';
            
            // Update buttons
            prevBtn.disabled = currentPage === 1;
            nextBtn.disabled = currentPage === totalPages;
            
            // Update page info
            pageInfo.textContent = `Pagina ${currentPage} di ${totalPages}`;
            
            // Update button styles
            prevBtn.classList.toggle('opacity-50', currentPage === 1);
            nextBtn.classList.toggle('opacity-50', currentPage === totalPages);
        }

        async function filterByCategory(categoryId) {
            currentCategory = categoryId;
            currentPage = 1;
            
            // Update active filter button
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const activeBtn = document.querySelector(`[data-category="${categoryId}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            // Load articles with filter
            await loadArticles();
        }

        async function changePage(direction) {
            const newPage = currentPage + direction;
            
            if (newPage < 1 || newPage > totalPages) {
                return;
            }
            
            currentPage = newPage;
            await loadArticles();
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Utility functions
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('it-IT', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        function estimateReadingTime(content) {
            const wordsPerMinute = 200;
            const words = content.split(' ').length;
            return Math.ceil(words / wordsPerMinute);
        }

        // Error handling
        window.addEventListener('error', function(e) {
            console.error('❌ Page error:', e.error);
        });
    </script>
<script defer src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" data-cf-beacon='{"rayId":"960b0f56b86442b0","serverTiming":{"name":{"cfExtPri":true,"cfEdge":true,"cfOrigin":true,"cfL4":true,"cfSpeedBrain":true,"cfCacheStatus":true}},"version":"2025.7.0","token":"4edd5f8ec12a48cfa682ab8261b80a79"}' crossorigin="anonymous"></script>
</body>
    